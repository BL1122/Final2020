---
title: "Covid91 vaccine study Final2021"
author: "Bessie Luevano"
date: "Summer 2021"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
OldData <-read.csv(file="covid91.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- OldData %>% mutate(infected = recode(infected, aids = "covid", none = "OK" )) %>% select(-one_of("X"))
FinalData$treatment <- as.factor(FinalData$treatment)
FinalData$sex <- as.factor(FinalData$sex)
FinalData$infected <- as.factor(FinalData$infected)
FinalData$LGBTQ <- as.factor(FinalData$LGBTQ)
FinalData$DrugUser <- as.factor(FinalData$DrugUser)
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

# Methods

The first step is to isolate the subpopulations
```{r}
maledata<- filter(FinalData,sex=="guy")
maledata$sex <- as.factor(maledata$sex)
```


# Guys "sex = guy"

## Bar Chart 

```{r}
Guys <- maledata %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(Guys,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(Guys,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

It appears in the bar chart that around 58% of males that were given the drug got Covid-19. About 42% of males that got Covid-19 were given the placebo. It appears that the bar chart shows that males you received the vaccine were about 50% more likely to contract covid-19. 

## Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected, data=maledata)
rowPerc(table1)
colPerc(table1)
print(table1)
```

The numerical summary shows that 337 males got infected with Covid-19 out of a total of 10,450 males in the study. It appears in the table that 3.72% of the males that received the drug got covid-19 and 2.55% of the males that received the placebo got covid-19. It doesn't appear that the drug is effective at preventing covid within this study of males.

## Inferential  

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

In the table using Chi-squared test shows that the p-vaule is 0.0006181 which is smaller that 1. It appears in the Fisher's Exact Test that you are 1.47% more likely to contract covid-19 if you take the drug. The Effectiveness of the drug is 59.5% using the formula 1.47/2.47*100= 59.5%. Therefore the vaccine is only 40% effective in th male population and doesn't seem to be effective. We can reject the null hypothesis because the drug is ineffective in preventing Covid-19 within males. 

# Gals "sex = gal"

```{r}
femaledata<- filter(FinalData,sex=="gal")
femaledata$sex <- as.factor(femaledata$sex)
```

## Bar Chart 

```{r}
Gals <- femaledata %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(Gals,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(Gals,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```



## Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected, data=femaledata)
rowPerc(table1)
colPerc(table1)
print(table1)
```



## Inferential

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```


# Sexual Orientation "LGBTQ = gay"


# Drug Users "Drug User = yes"


# Discussion & Conclusion










